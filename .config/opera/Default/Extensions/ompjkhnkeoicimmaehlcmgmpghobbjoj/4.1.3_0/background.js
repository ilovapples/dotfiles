/*! For license information please see background.js.LICENSE.txt */
(()=>{var e={3738:e=>{function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},4633:(e,t,r)=>{var n=r(3738).default;function a(){"use strict";e.exports=a=function(){return r},e.exports.__esModule=!0,e.exports.default=e.exports;var t,r={},s=Object.prototype,o=s.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},c="function"==typeof Symbol?Symbol:{},u=c.iterator||"@@iterator",l=c.asyncIterator||"@@asyncIterator",h=c.toStringTag||"@@toStringTag";function f(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(t){f=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var a=t&&t.prototype instanceof b?t:b,s=Object.create(a.prototype),o=new N(n||[]);return i(s,"_invoke",{value:I(e,r,o)}),s}function p(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}r.wrap=d;var g="suspendedStart",m="suspendedYield",v="executing",A="completed",y={};function b(){}function x(){}function O(){}var w={};f(w,u,(function(){return this}));var S=Object.getPrototypeOf,E=S&&S(S(G([])));E&&E!==s&&o.call(E,u)&&(w=E);var _=O.prototype=b.prototype=Object.create(w);function T(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function P(e,t){function r(a,s,i,c){var u=p(e[a],e,s);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==n(h)&&o.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,i,c)}),(function(e){r("throw",e,i,c)})):t.resolve(h).then((function(e){l.value=e,i(l)}),(function(e){return r("throw",e,i,c)}))}c(u.arg)}var a;i(this,"_invoke",{value:function(e,n){function s(){return new t((function(t,a){r(e,n,t,a)}))}return a=a?a.then(s,s):s()}})}function I(e,r,n){var a=g;return function(s,o){if(a===v)throw Error("Generator is already running");if(a===A){if("throw"===s)throw o;return{value:t,done:!0}}for(n.method=s,n.arg=o;;){var i=n.delegate;if(i){var c=k(i,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===g)throw a=A,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=v;var u=p(e,r,n);if("normal"===u.type){if(a=n.done?A:m,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=A,n.method="throw",n.arg=u.arg)}}}function k(e,r){var n=r.method,a=e.iterator[n];if(a===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var s=p(a,e.iterator,r.arg);if("throw"===s.type)return r.method="throw",r.arg=s.arg,r.delegate=null,y;var o=s.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function G(e){if(e||""===e){var r=e[u];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,s=function r(){for(;++a<e.length;)if(o.call(e,a))return r.value=e[a],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}throw new TypeError(n(e)+" is not iterable")}return x.prototype=O,i(_,"constructor",{value:O,configurable:!0}),i(O,"constructor",{value:x,configurable:!0}),x.displayName=f(O,h,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===x||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,O):(e.__proto__=O,f(e,h,"GeneratorFunction")),e.prototype=Object.create(_),e},r.awrap=function(e){return{__await:e}},T(P.prototype),f(P.prototype,l,(function(){return this})),r.AsyncIterator=P,r.async=function(e,t,n,a,s){void 0===s&&(s=Promise);var o=new P(d(e,t,n,a),s);return r.isGeneratorFunction(t)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},T(_),f(_,h,"Generator"),f(_,u,(function(){return this})),f(_,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},r.values=G,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,a){return i.type="throw",i.arg=e,r.next=n,a&&(r.method="next",r.arg=t),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],i=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var c=o.call(s,"catchLoc"),u=o.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=t,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),L(r),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;L(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:G(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},r}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},4756:(e,t,r)=>{var n=r(4633)();e.exports=n;try{regeneratorRuntime=n}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},6540:(e,t,r)=>{"use strict";r(9869)},6815:function(e,t){var r,n;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,r=function(e){"use strict";if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)e.exports=globalThis.browser;else{const t="The message port closed before a response was received.",r=e=>{const r={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(r).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class n extends WeakMap{constructor(e,t=void 0){super(t),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const a=(t,r)=>(...n)=>{e.runtime.lastError?t.reject(new Error(e.runtime.lastError.message)):r.singleCallbackArg||n.length<=1&&!1!==r.singleCallbackArg?t.resolve(n[0]):t.resolve(n)},s=e=>1==e?"argument":"arguments",o=(e,t,r)=>new Proxy(t,{apply:(t,n,a)=>r.call(n,e,...a)});let i=Function.call.bind(Object.prototype.hasOwnProperty);const c=(e,t={},r={})=>{let n=Object.create(null),u={has:(t,r)=>r in e||r in n,get(u,l,h){if(l in n)return n[l];if(!(l in e))return;let f=e[l];if("function"==typeof f)if("function"==typeof t[l])f=o(e,e[l],t[l]);else if(i(r,l)){let t=((e,t)=>function(r,...n){if(n.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${s(t.minArgs)} for ${e}(), got ${n.length}`);if(n.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${s(t.maxArgs)} for ${e}(), got ${n.length}`);return new Promise(((s,o)=>{if(t.fallbackToNoCallback)try{r[e](...n,a({resolve:s,reject:o},t))}catch(a){console.warn(`${e} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,a),r[e](...n),t.fallbackToNoCallback=!1,t.noCallback=!0,s()}else t.noCallback?(r[e](...n),s()):r[e](...n,a({resolve:s,reject:o},t))}))})(l,r[l]);f=o(e,e[l],t)}else f=f.bind(e);else if("object"==typeof f&&null!==f&&(i(t,l)||i(r,l)))f=c(f,t[l],r[l]);else{if(!i(r,"*"))return Object.defineProperty(n,l,{configurable:!0,enumerable:!0,get:()=>e[l],set(t){e[l]=t}}),f;f=c(f,t[l],r["*"])}return n[l]=f,f},set:(t,r,a,s)=>(r in n?n[r]=a:e[r]=a,!0),defineProperty:(e,t,r)=>Reflect.defineProperty(n,t,r),deleteProperty:(e,t)=>Reflect.deleteProperty(n,t)},l=Object.create(e);return new Proxy(l,u)},u=e=>({addListener(t,r,...n){t.addListener(e.get(r),...n)},hasListener:(t,r)=>t.hasListener(e.get(r)),removeListener(t,r){t.removeListener(e.get(r))}}),l=new n((e=>"function"!=typeof e?e:function(t){const r=c(t,{},{getContent:{minArgs:0,maxArgs:0}});e(r)})),h=new n((e=>"function"!=typeof e?e:function(t,r,n){let a,s,o=!1,i=new Promise((e=>{a=function(t){o=!0,e(t)}}));try{s=e(t,r,a)}catch(e){s=Promise.reject(e)}const c=!0!==s&&((u=s)&&"object"==typeof u&&"function"==typeof u.then);var u;if(!0!==s&&!c&&!o)return!1;return(c?s:i).then((e=>{n(e)}),(e=>{let t;t=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",n({__mozWebExtensionPolyfillReject__:!0,message:t})})).catch((e=>{console.error("Failed to send onMessage rejected reply",e)})),!0})),f=({reject:r,resolve:n},a)=>{e.runtime.lastError?e.runtime.lastError.message===t?n():r(new Error(e.runtime.lastError.message)):a&&a.__mozWebExtensionPolyfillReject__?r(new Error(a.message)):n(a)},d=(e,t,r,...n)=>{if(n.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${s(t.minArgs)} for ${e}(), got ${n.length}`);if(n.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${s(t.maxArgs)} for ${e}(), got ${n.length}`);return new Promise(((e,t)=>{const a=f.bind(null,{resolve:e,reject:t});n.push(a),r.sendMessage(...n)}))},p={devtools:{network:{onRequestFinished:u(l)}},runtime:{onMessage:u(h),onMessageExternal:u(h),sendMessage:d.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:d.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},g={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return r.privacy={network:{"*":g},services:{"*":g},websites:{"*":g}},c(e,p,r)};e.exports=r(chrome)}},void 0===(n=r.apply(t,[e]))||(e.exports=n)},9869:(e,t)=>{"use strict";Symbol.for("react.transitional.element"),Symbol.for("react.portal"),Symbol.for("react.fragment"),Symbol.for("react.strict_mode"),Symbol.for("react.profiler"),Symbol.for("react.consumer"),Symbol.for("react.context"),Symbol.for("react.forward_ref"),Symbol.for("react.suspense"),Symbol.for("react.memo"),Symbol.for("react.lazy"),Symbol.iterator;var r={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},n=Object.assign,a={};function s(e,t,n){this.props=e,this.context=t,this.refs=a,this.updater=n||r}function o(){}function i(e,t,n){this.props=e,this.context=t,this.refs=a,this.updater=n||r}s.prototype.isReactComponent={},s.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},s.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},o.prototype=s.prototype;var c=i.prototype=new o;c.constructor=i,n(c,s.prototype),c.isPureReactComponent=!0;Array.isArray,Object.prototype.hasOwnProperty;"function"==typeof reportError&&reportError}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";function e(e,t,r,n,a,s,o){try{var i=e[s](o),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(n,a)}function t(t){return function(){var r=this,n=arguments;return new Promise((function(a,s){var o=t.apply(r,n);function i(t){e(o,a,s,i,c,"next",t)}function c(t){e(o,a,s,i,c,"throw",t)}i(void 0)}))}}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function a(e,t,r){return(t=function(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=r(4756),o=r.n(s),i=r(6815),c=r.n(i),u=!1;c().storage.local.get().then((function(e){u=!!e.staging&&!!e.staging}));var l=function(){return u},h=function(){return u?"https://cashback.op-test.net/":"https://cashback.opera.com/"};function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,s,o,i=[],c=!0,u=!1;try{if(s=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=s.call(r)).done)&&(i.push(n.value),i.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var p=function(e){return e.Chrome="Chrome",e.Opera="Opera",e.OperaGX="OperaGX",e.Safari="Safari",e.Firefox="Firefox",e.Other="Other",e}({}),g=function(e){return e.ACTIVATION="ACTIVATION",e.NOT_PARTNER="NOT_PARTNER",e.COMPETITOR="COMPETITOR",e.CHECKOUT="CHECKOUT",e.WELCOME="WELCOME",e.PROMO="PROMO",e.MAIN_NON_AUTOMATIC="MAIN_NON_AUTOMATIC",e}({}),m=function(e){return e.DONT_OPEN_AGAIN="dont_open_again",e.DONT_OPEN_AGAIN_TODAY="dont_open_again_today",e.DONT_OPEN_ALL_SHOPS="dont_open_all_shops",e.DISABLE_SAVING_GOALS="disable_saving_goals",e}({}),v=function(e){return e.ACTIVATE_CASHBACK="ACTIVATE_CASHBACK",e.POPUP_SEEN="POPUP_SEEN",e.FETCH_OFFER_DATA="FETCH_OFFER_DATA",e.OFFER_DATA="OFFER_DATA",e.SEND_STATS="SEND_STATS",e.GET_SETTINGS_FOR_PAGE="GET_SETTINGS_FOR_PAGE",e.SETTINGS_FOR_PAGE="SETTINGS_FOR_PAGE",e.SET_SETTINGS_FOR_PAGE="SET_SETTINGS_FOR_PAGE",e.GET_VERSION="GET_VERSION",e.VERSION="VERSION",e.IS_LOGGED="IS_LOGGED",e.SET_LANGUAGE="SET_LANGUAGE",e.SET_STAGING="SET_STAGING",e.SET_SAVING_GOAL="SET_SAVING_GOAL",e.GET_SAVING_GOAL_DATA="GET_SAVING_GOAL_DATA",e.SAVING_GOAL_DATA="SAVING_GOAL_DATA",e.GET_SAVING_GOAL_BALANCE="GET_SAVING_GOAL_BALANCE",e.SAVING_GOAL_BALANCE="SAVING_GOAL_BALANCE",e.GET_SAVING_GOAL_TEMPLATES="GET_SAVING_GOAL_TEMPLATES",e.SAVING_GOAL_TEMPLATES="SAVING_GOAL_TEMPLATES",e.UPDATE_SAVING_GOAL="UPDATE_SAVING_GOAL",e.INCREASE_SAVING_GOAL_COUNTER="INCREASE_SAVING_GOAL_COUNTER",e.RESET_SAVING_GOAL_COUNTER="RESET_SAVING_GOAL_COUNTER",e.MARK_PENDING_VIEW_SECTION="MARK_PENDING_VIEW_SECTION",e.RESET_STORAGE="RESET_STORAGE",e}({});function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var b=["google.com","facebook.com","instagram.com","twitter.com","whatsapp.com","tiktok.com","reddit.com","linkedin.com","vk.com","discord.com","messenger.com","telegram.org","tumblr.com","slack.com"],x=new Date("9 Dec 2023 0:0:0 GMT+1"),O=new Date("11 Dec 2023 23:59:59 GMT+1"),w=new Date("16 Dec 2023 0:0:0 GMT+1"),S=new Date("18 Dec 2023 23:59:59 GMT+1"),E=function(){var e=Date.now();return e>Number(x)&&e<Number(O)},_=function(e){var t,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(!r||function(e){return b.reduce((function(t,r){return t&&-1===e.host.indexOf(r)}),!0)}(r))&&e!==p.OperaGX&&(E()&&1!==n.counter1||(t=Date.now())>Number(w)&&t<Number(S)&&1!==n.counter2)};r(6540);var T,P=function(e){return e.LIGHT="light",e.DARK="dark",e}({}),I=function(e){return e[e.Extension=0]="Extension",e[e.Activator=1]="Activator",e}({}),k=function(e){return e[e.SHOWN=0]="SHOWN",e[e.DETAILS=1]="DETAILS",e[e.SETTINGS=2]="SETTINGS",e[e.SAVING_GOALS=3]="SAVING_GOALS",e[e.CLOSING=4]="CLOSING",e[e.CLOSED=5]="CLOSED",e}({});function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}p.Opera,P.LIGHT,g.ACTIVATION,k.SHOWN,k.SHOWN,k.SHOWN,I.Extension;var N,G=!1,R=!1,D=function(){var e=t(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!R){e.next=2;break}return e.abrupt("return");case 2:if(!q||null===(t=globalThis.opr)||void 0===t||null===(t=t.operaBrowserPrivate)||void 0===t||!t.getProduct){e.next=7;break}return e.next=5,opr.operaBrowserPrivate.getProduct();case 5:e.t0=e.sent,G="Opera GX"===e.t0;case 7:R=!0;case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=function(){if(!R)throw"Using uninitialised getBrowser";return N||(N=function(){var e=globalThis.chrome,t=globalThis.navigator.userAgent.toLowerCase(),r=void 0!==globalThis.opr,n=t.indexOf("firefox")>-1,a=t.indexOf("safari")>-1,s=t.indexOf("edge")>-1;if(t.match("crios"));else{if(null!=e&&!1===r&&!1===s)return p.Chrome;if(r)return G?p.OperaGX:p.Opera;if(n)return p.Firefox;if(a)return p.Safari}return p.Other}())},M=function(e,t,r){var n=new URL(t).hostname.split(".").slice(-e.split(".").length).join(".")===e;return r.forEach((function(e){return n=n&&-1===t.indexOf(e)})),n},F=function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=new URL(e.url);if(!U){var s=a.search.substring(1).split("&"),o=/cjevent/i,i=!1;if(s.forEach((function(e){var t=d(e.split("="),2),r=t[0],n=t[1];(o.test(r)||o.test(n))&&(i=!0)})),i&&!e.isActivated)return!1}if("ebay"===function(e){return e.split(".").splice(-2,1)[0].toLowerCase()}(a.host)){var c=!1,u=!1;if([e.url].concat(e.redirs).forEach((function(e){new URL(e).search.substring(1).split("&").forEach((function(e){var t=d(e.split("="),2),r=t[0],n=t[1];["mkevt","mkcid","campid"].includes(r)&&(u=!0),"campid"===r&&["5338944028","5338944027","5338930307","5338838092","5338837356","5338787428"].includes(n)&&(c=!0)}))})),u&&!c)return!1}if(j()===p.OperaGX){if(e.popup_type===g.NOT_PARTNER)return!1;if(-1===["GB","ES"].indexOf(null==t?void 0:t.toUpperCase())&&!e.isUserLoggedBefore)return!1}return n||Date.now()>(e.activated&&e.activated.closed_till||0)&&!(e.settingsForPage&&(e.settingsForPage[m.DONT_OPEN_ALL_SHOPS]||e.settingsForPage[m.DONT_OPEN_AGAIN]||e.settingsForPage[m.DONT_OPEN_AGAIN_TODAY]&&e.settingsForPage[m.DONT_OPEN_AGAIN_TODAY]>Date.now()))&&(U?!e.offer.disableAssistant:e.isActivated&&e.offer.showPopupCbActivated||!e.isActivated&&(null===(r=e.offer)||void 0===r?void 0:r.showPopupActivateCb))},q=globalThis.opr,U=!(null===(T=globalThis.opr)||void 0===T||null===(T=T.cashbackPrivate)||void 0===T||!T.onCashbackButtonPressed),B=q&&chrome.runtime.getManifest().name.toLowerCase().indexOf("assistant")>-1&&!U,V=(new URL(globalThis.location.toString()).searchParams.get("id"),function(){var e;return null!==(e=globalThis.matchMedia&&globalThis.matchMedia("(prefers-color-scheme: dark)").matches)&&void 0!==e&&e}),K=function(){return c().runtime.getManifest().version},Q=function(){var e=t(o().mark((function e(r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c().tabs.query(L({active:!0},r?{windowId:Number(r)}:{})).then(function(){var e=t(o().mark((function e(t){var n,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t[0].workspaceId,!U||!a){e.next=8;break}return e.next=4,new Promise((function(e){return opr.workspacesPrivate.getActiveWorkspaceId(Number(r),e)}));case 4:s=e.sent,n=t.find((function(e){return e.workspaceId===s.toString()&&e.windowId===r})),e.next=9;break;case 8:n=t[0];case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=function(e){try{return new URL(e)}catch(t){return console.error("Cannot create URL - provided string: ".concat(e," ").concat(t)),null}},W=function(e,t){for(var r=null==e?void 0:e.map((function(e){var t;return null===(t=H(e.url))||void 0===t?void 0:t.host})),n=t.host.split("."),a=n.length;a>1;a--)if(r.includes(n.slice(-a).join(".")))return!0;return!1},$=function(e,t){for(var r=Object.fromEntries(null==e?void 0:e.map((function(e){var t;return[null===(t=H(e.url))||void 0===t?void 0:t.host,e.merchantIds]}))),n=t.host.split("."),a=n.length;a>1;a--){var s=n.slice(-a).join(".");if(r[s])return r[s]}return[]},Y="undefined"==typeof window||"Deno"in globalThis;function X(){}function J(e,t){return"function"==typeof e?e(t):e}function z(e,t){const{type:r="all",exact:n,fetchStatus:a,predicate:s,queryKey:o,stale:i}=e;if(o)if(n){if(t.queryHash!==ee(o,t.options))return!1}else if(!re(t.queryKey,o))return!1;if("all"!==r){const e=t.isActive();if("active"===r&&!e)return!1;if("inactive"===r&&e)return!1}return!("boolean"==typeof i&&t.isStale()!==i||a&&a!==t.state.fetchStatus||s&&!s(t))}function Z(e,t){const{exact:r,status:n,predicate:a,mutationKey:s}=e;if(s){if(!t.options.mutationKey)return!1;if(r){if(te(t.options.mutationKey)!==te(s))return!1}else if(!re(t.options.mutationKey,s))return!1}return!(n&&t.state.status!==n||a&&!a(t))}function ee(e,t){return(t?.queryKeyHashFn||te)(e)}function te(e){return JSON.stringify(e,((e,t)=>se(t)?Object.keys(t).sort().reduce(((e,r)=>(e[r]=t[r],e)),{}):t))}function re(e,t){return e===t||typeof e==typeof t&&!(!e||!t||"object"!=typeof e||"object"!=typeof t)&&!Object.keys(t).some((r=>!re(e[r],t[r])))}function ne(e,t){if(e===t)return e;const r=ae(e)&&ae(t);if(r||se(e)&&se(t)){const n=r?e:Object.keys(e),a=n.length,s=r?t:Object.keys(t),o=s.length,i=r?[]:{};let c=0;for(let a=0;a<o;a++){const o=r?a:s[a];(!r&&n.includes(o)||r)&&void 0===e[o]&&void 0===t[o]?(i[o]=void 0,c++):(i[o]=ne(e[o],t[o]),i[o]===e[o]&&void 0!==e[o]&&c++)}return a===o&&c===a?e:i}return t}function ae(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function se(e){if(!oe(e))return!1;const t=e.constructor;if(void 0===t)return!0;const r=t.prototype;return!!oe(r)&&!!r.hasOwnProperty("isPrototypeOf")&&Object.getPrototypeOf(e)===Object.prototype}function oe(e){return"[object Object]"===Object.prototype.toString.call(e)}function ie(e,t,r){return"function"==typeof r.structuralSharing?r.structuralSharing(e,t):!1!==r.structuralSharing?ne(e,t):t}function ce(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function ue(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var le=Symbol();function he(e,t){return!e.queryFn&&t?.initialPromise?()=>t.initialPromise:e.queryFn&&e.queryFn!==le?e.queryFn:()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`))}var fe=e=>setTimeout(e,0),de=function(){let e=[],t=0,r=e=>{e()},n=e=>{e()},a=fe;const s=n=>{t?e.push(n):a((()=>{r(n)}))};return{batch:s=>{let o;t++;try{o=s()}finally{t--,t||(()=>{const t=e;e=[],t.length&&a((()=>{n((()=>{t.forEach((e=>{r(e)}))}))}))})()}return o},batchCalls:e=>(...t)=>{s((()=>{e(...t)}))},schedule:s,setNotifyFunction:e=>{r=e},setBatchNotifyFunction:e=>{n=e},setScheduler:e=>{a=e}}}(),pe=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},ge=new class extends pe{#e;#t;#r;constructor(){super(),this.#r=e=>{if(!Y&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(e){this.#r=e,this.#t?.(),this.#t=e((e=>{"boolean"==typeof e?this.setFocused(e):this.onFocus()}))}setFocused(e){this.#e!==e&&(this.#e=e,this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach((t=>{t(e)}))}isFocused(){return"boolean"==typeof this.#e?this.#e:"hidden"!==globalThis.document?.visibilityState}},me=new class extends pe{#n=!0;#t;#r;constructor(){super(),this.#r=e=>{if(!Y&&window.addEventListener){const t=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",r)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(e){this.#r=e,this.#t?.(),this.#t=e(this.setOnline.bind(this))}setOnline(e){this.#n!==e&&(this.#n=e,this.listeners.forEach((t=>{t(e)})))}isOnline(){return this.#n}};function ve(e){return Math.min(1e3*2**e,3e4)}function Ae(e){return"online"!==(e??"online")||me.isOnline()}var ye=class extends Error{constructor(e){super("CancelledError"),this.revert=e?.revert,this.silent=e?.silent}};function be(e){return e instanceof ye}function xe(e){let t,r=!1,n=0,a=!1;const s=function(){let e,t;const r=new Promise(((r,n)=>{e=r,t=n}));function n(e){Object.assign(r,e),delete r.resolve,delete r.reject}return r.status="pending",r.catch((()=>{})),r.resolve=t=>{n({status:"fulfilled",value:t}),e(t)},r.reject=e=>{n({status:"rejected",reason:e}),t(e)},r}(),o=()=>ge.isFocused()&&("always"===e.networkMode||me.isOnline())&&e.canRun(),i=()=>Ae(e.networkMode)&&e.canRun(),c=r=>{a||(a=!0,e.onSuccess?.(r),t?.(),s.resolve(r))},u=r=>{a||(a=!0,e.onError?.(r),t?.(),s.reject(r))},l=()=>new Promise((r=>{t=e=>{(a||o())&&r(e)},e.onPause?.()})).then((()=>{t=void 0,a||e.onContinue?.()})),h=()=>{if(a)return;let t;const s=0===n?e.initialPromise:void 0;try{t=s??e.fn()}catch(e){t=Promise.reject(e)}Promise.resolve(t).then(c).catch((t=>{if(a)return;const s=e.retry??(Y?0:3),i=e.retryDelay??ve,c="function"==typeof i?i(n,t):i,f=!0===s||"number"==typeof s&&n<s||"function"==typeof s&&s(n,t);var d;!r&&f?(n++,e.onFail?.(n,t),(d=c,new Promise((e=>{setTimeout(e,d)}))).then((()=>o()?void 0:l())).then((()=>{r?u(t):h()}))):u(t)}))};return{promise:s,cancel:t=>{a||(u(new ye(t)),e.abort?.())},continue:()=>(t?.(),s),cancelRetry:()=>{r=!0},continueRetry:()=>{r=!1},canStart:i,start:()=>(i()?h():l().then(h),s)}}var Oe=class{#a;destroy(){this.clearGcTimeout()}scheduleGc(){var e;this.clearGcTimeout(),"number"==typeof(e=this.gcTime)&&e>=0&&e!==1/0&&(this.#a=setTimeout((()=>{this.optionalRemove()}),this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Y?1/0:3e5))}clearGcTimeout(){this.#a&&(clearTimeout(this.#a),this.#a=void 0)}},we=class extends Oe{#s;#o;#i;#c;#u;#l;#h;constructor(e){super(),this.#h=!1,this.#l=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#c=e.client,this.#i=this.#c.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#s=function(e){const t="function"==typeof e.initialData?e.initialData():e.initialData,r=void 0!==t,n=r?"function"==typeof e.initialDataUpdatedAt?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}(this.options),this.state=e.state??this.#s,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#u?.promise}setOptions(e){this.options={...this.#l,...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){this.observers.length||"idle"!==this.state.fetchStatus||this.#i.remove(this)}setData(e,t){const r=ie(this.state.data,e,this.options);return this.#f({data:r,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),r}setState(e,t){this.#f({type:"setState",state:e,setStateOptions:t})}cancel(e){const t=this.#u?.promise;return this.#u?.cancel(e),t?t.then(X).catch(X):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#s)}isActive(){return this.observers.some((e=>{return!1!==("function"==typeof(t=e.options.enabled)?t(this):t);var t}))}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===le||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return!!this.state.isInvalidated||(this.getObserversCount()>0?this.observers.some((e=>e.getCurrentResult().isStale)):void 0===this.state.data)}isStaleByTime(e=0){return this.state.isInvalidated||void 0===this.state.data||!function(e,t){return Math.max(e+(t||0)-Date.now(),0)}(this.state.dataUpdatedAt,e)}onFocus(){const e=this.observers.find((e=>e.shouldFetchOnWindowFocus()));e?.refetch({cancelRefetch:!1}),this.#u?.continue()}onOnline(){const e=this.observers.find((e=>e.shouldFetchOnReconnect()));e?.refetch({cancelRefetch:!1}),this.#u?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#i.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter((t=>t!==e)),this.observers.length||(this.#u&&(this.#h?this.#u.cancel({revert:!0}):this.#u.cancelRetry()),this.scheduleGc()),this.#i.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#f({type:"invalidate"})}fetch(e,t){if("idle"!==this.state.fetchStatus)if(void 0!==this.state.data&&t?.cancelRefetch)this.cancel({silent:!0});else if(this.#u)return this.#u.continueRetry(),this.#u.promise;if(e&&this.setOptions(e),!this.options.queryFn){const e=this.observers.find((e=>e.options.queryFn));e&&this.setOptions(e.options)}const r=new AbortController,n=e=>{Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(this.#h=!0,r.signal)})},a={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:this.#c,state:this.state,fetchFn:()=>{const e=he(this.options,t),r={client:this.#c,queryKey:this.queryKey,meta:this.meta};return n(r),this.#h=!1,this.options.persister?this.options.persister(e,r,this):e(r)}};n(a),this.options.behavior?.onFetch(a,this),this.#o=this.state,"idle"!==this.state.fetchStatus&&this.state.fetchMeta===a.fetchOptions?.meta||this.#f({type:"fetch",meta:a.fetchOptions?.meta});const s=e=>{be(e)&&e.silent||this.#f({type:"error",error:e}),be(e)||(this.#i.config.onError?.(e,this),this.#i.config.onSettled?.(this.state.data,e,this)),this.scheduleGc()};return this.#u=xe({initialPromise:t?.initialPromise,fn:a.fetchFn,abort:r.abort.bind(r),onSuccess:e=>{if(void 0!==e){try{this.setData(e)}catch(e){return void s(e)}this.#i.config.onSuccess?.(e,this),this.#i.config.onSettled?.(e,this.state.error,this),this.scheduleGc()}else s(new Error(`${this.queryHash} data is undefined`))},onError:s,onFail:(e,t)=>{this.#f({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#f({type:"pause"})},onContinue:()=>{this.#f({type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0}),this.#u.start()}#f(e){this.state=(t=>{switch(e.type){case"failed":return{...t,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...t,fetchStatus:"paused"};case"continue":return{...t,fetchStatus:"fetching"};case"fetch":return{...t,...(r=t.data,n=this.options,{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Ae(n.networkMode)?"fetching":"paused",...void 0===r&&{error:null,status:"pending"}}),fetchMeta:e.meta??null};case"success":return{...t,data:e.data,dataUpdateCount:t.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=e.error;return be(a)&&a.revert&&this.#o?{...this.#o,fetchStatus:"idle"}:{...t,error:a,errorUpdateCount:t.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:t.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...t,isInvalidated:!0};case"setState":return{...t,...e.state}}var r,n})(this.state),de.batch((()=>{this.observers.forEach((e=>{e.onQueryUpdate()})),this.#i.notify({query:this,type:"updated",action:e})}))}},Se=class extends pe{constructor(e={}){super(),this.config=e,this.#d=new Map}#d;build(e,t,r){const n=t.queryKey,a=t.queryHash??ee(n,t);let s=this.get(a);return s||(s=new we({client:e,queryKey:n,queryHash:a,options:e.defaultQueryOptions(t),state:r,defaultOptions:e.getQueryDefaults(n)}),this.add(s)),s}add(e){this.#d.has(e.queryHash)||(this.#d.set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=this.#d.get(e.queryHash);t&&(e.destroy(),t===e&&this.#d.delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){de.batch((()=>{this.getAll().forEach((e=>{this.remove(e)}))}))}get(e){return this.#d.get(e)}getAll(){return[...this.#d.values()]}find(e){const t={exact:!0,...e};return this.getAll().find((e=>z(t,e)))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter((t=>z(e,t))):t}notify(e){de.batch((()=>{this.listeners.forEach((t=>{t(e)}))}))}onFocus(){de.batch((()=>{this.getAll().forEach((e=>{e.onFocus()}))}))}onOnline(){de.batch((()=>{this.getAll().forEach((e=>{e.onOnline()}))}))}},Ee=class extends Oe{#p;#g;#u;constructor(e){super(),this.mutationId=e.mutationId,this.#g=e.mutationCache,this.#p=[],this.state=e.state||{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0},this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#p.includes(e)||(this.#p.push(e),this.clearGcTimeout(),this.#g.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#p=this.#p.filter((t=>t!==e)),this.scheduleGc(),this.#g.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#p.length||("pending"===this.state.status?this.scheduleGc():this.#g.remove(this))}continue(){return this.#u?.continue()??this.execute(this.state.variables)}async execute(e){this.#u=xe({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(e,t)=>{this.#f({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#f({type:"pause"})},onContinue:()=>{this.#f({type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#g.canRun(this)});const t="pending"===this.state.status,r=!this.#u.canStart();try{if(!t){this.#f({type:"pending",variables:e,isPaused:r}),await(this.#g.config.onMutate?.(e,this));const t=await(this.options.onMutate?.(e));t!==this.state.context&&this.#f({type:"pending",context:t,variables:e,isPaused:r})}const n=await this.#u.start();return await(this.#g.config.onSuccess?.(n,e,this.state.context,this)),await(this.options.onSuccess?.(n,e,this.state.context)),await(this.#g.config.onSettled?.(n,null,this.state.variables,this.state.context,this)),await(this.options.onSettled?.(n,null,e,this.state.context)),this.#f({type:"success",data:n}),n}catch(t){try{throw await(this.#g.config.onError?.(t,e,this.state.context,this)),await(this.options.onError?.(t,e,this.state.context)),await(this.#g.config.onSettled?.(void 0,t,this.state.variables,this.state.context,this)),await(this.options.onSettled?.(void 0,t,e,this.state.context)),t}finally{this.#f({type:"error",error:t})}}finally{this.#g.runNext(this)}}#f(e){this.state=(t=>{switch(e.type){case"failed":return{...t,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...t,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:e.error,failureCount:t.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}})(this.state),de.batch((()=>{this.#p.forEach((t=>{t.onMutationUpdate(e)})),this.#g.notify({mutation:this,type:"updated",action:e})}))}},_e=class extends pe{constructor(e={}){super(),this.config=e,this.#m=new Set,this.#v=new Map,this.#A=0}#m;#v;#A;build(e,t,r){const n=new Ee({mutationCache:this,mutationId:++this.#A,options:e.defaultMutationOptions(t),state:r});return this.add(n),n}add(e){this.#m.add(e);const t=Te(e);if("string"==typeof t){const r=this.#v.get(t);r?r.push(e):this.#v.set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(this.#m.delete(e)){const t=Te(e);if("string"==typeof t){const r=this.#v.get(t);if(r)if(r.length>1){const t=r.indexOf(e);-1!==t&&r.splice(t,1)}else r[0]===e&&this.#v.delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=Te(e);if("string"==typeof t){const r=this.#v.get(t),n=r?.find((e=>"pending"===e.state.status));return!n||n===e}return!0}runNext(e){const t=Te(e);if("string"==typeof t){const r=this.#v.get(t)?.find((t=>t!==e&&t.state.isPaused));return r?.continue()??Promise.resolve()}return Promise.resolve()}clear(){de.batch((()=>{this.#m.forEach((e=>{this.notify({type:"removed",mutation:e})})),this.#m.clear(),this.#v.clear()}))}getAll(){return Array.from(this.#m)}find(e){const t={exact:!0,...e};return this.getAll().find((e=>Z(t,e)))}findAll(e={}){return this.getAll().filter((t=>Z(e,t)))}notify(e){de.batch((()=>{this.listeners.forEach((t=>{t(e)}))}))}resumePausedMutations(){const e=this.getAll().filter((e=>e.state.isPaused));return de.batch((()=>Promise.all(e.map((e=>e.continue().catch(X))))))}};function Te(e){return e.options.scope?.id}function Pe(e){return{onFetch:(t,r)=>{const n=t.options,a=t.fetchOptions?.meta?.fetchMore?.direction,s=t.state.data?.pages||[],o=t.state.data?.pageParams||[];let i={pages:[],pageParams:[]},c=0;const u=async()=>{let r=!1;const u=he(t.options,t.fetchOptions),l=async(e,n,a)=>{if(r)return Promise.reject();if(null==n&&e.pages.length)return Promise.resolve(e);const s={client:t.client,queryKey:t.queryKey,pageParam:n,direction:a?"backward":"forward",meta:t.options.meta};var o;o=s,Object.defineProperty(o,"signal",{enumerable:!0,get:()=>(t.signal.aborted?r=!0:t.signal.addEventListener("abort",(()=>{r=!0})),t.signal)});const i=await u(s),{maxPages:c}=t.options,l=a?ue:ce;return{pages:l(e.pages,i,c),pageParams:l(e.pageParams,n,c)}};if(a&&s.length){const e="backward"===a,t={pages:s,pageParams:o},r=(e?ke:Ie)(n,t);i=await l(t,r,e)}else{const t=e??s.length;do{const e=0===c?o[0]??n.initialPageParam:Ie(n,i);if(c>0&&null==e)break;i=await l(i,e),c++}while(c<t)}return i};t.options.persister?t.fetchFn=()=>t.options.persister?.(u,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r):t.fetchFn=u}}}function Ie(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function ke(e,{pages:t,pageParams:r}){return t.length>0?e.getPreviousPageParam?.(t[0],t,r[0],r):void 0}var Ce,Le=new class{#y;#g;#l;#b;#x;#O;#w;#S;constructor(e={}){this.#y=e.queryCache||new Se,this.#g=e.mutationCache||new _e,this.#l=e.defaultOptions||{},this.#b=new Map,this.#x=new Map,this.#O=0}mount(){this.#O++,1===this.#O&&(this.#w=ge.subscribe((async e=>{e&&(await this.resumePausedMutations(),this.#y.onFocus())})),this.#S=me.subscribe((async e=>{e&&(await this.resumePausedMutations(),this.#y.onOnline())})))}unmount(){this.#O--,0===this.#O&&(this.#w?.(),this.#w=void 0,this.#S?.(),this.#S=void 0)}isFetching(e){return this.#y.findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return this.#g.findAll({...e,status:"pending"}).length}getQueryData(e){const t=this.defaultQueryOptions({queryKey:e});return this.#y.get(t.queryHash)?.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=this.#y.build(this,t),n=r.state.data;return void 0===n?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(J(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return this.#y.findAll(e).map((({queryKey:e,state:t})=>[e,t.data]))}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),a=this.#y.get(n.queryHash),s=a?.state.data,o=function(e,t){return"function"==typeof e?e(t):e}(t,s);if(void 0!==o)return this.#y.build(this,n).setData(o,{...r,manual:!0})}setQueriesData(e,t,r){return de.batch((()=>this.#y.findAll(e).map((({queryKey:e})=>[e,this.setQueryData(e,t,r)]))))}getQueryState(e){const t=this.defaultQueryOptions({queryKey:e});return this.#y.get(t.queryHash)?.state}removeQueries(e){const t=this.#y;de.batch((()=>{t.findAll(e).forEach((e=>{t.remove(e)}))}))}resetQueries(e,t){const r=this.#y;return de.batch((()=>(r.findAll(e).forEach((e=>{e.reset()})),this.refetchQueries({type:"active",...e},t))))}cancelQueries(e,t={}){const r={revert:!0,...t},n=de.batch((()=>this.#y.findAll(e).map((e=>e.cancel(r)))));return Promise.all(n).then(X).catch(X)}invalidateQueries(e,t={}){return de.batch((()=>(this.#y.findAll(e).forEach((e=>{e.invalidate()})),"none"===e?.refetchType?Promise.resolve():this.refetchQueries({...e,type:e?.refetchType??e?.type??"active"},t))))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=de.batch((()=>this.#y.findAll(e).filter((e=>!e.isDisabled())).map((e=>{let t=e.fetch(void 0,r);return r.throwOnError||(t=t.catch(X)),"paused"===e.state.fetchStatus?Promise.resolve():t}))));return Promise.all(n).then(X)}fetchQuery(e){const t=this.defaultQueryOptions(e);void 0===t.retry&&(t.retry=!1);const r=this.#y.build(this,t);return r.isStaleByTime(J(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(X).catch(X)}fetchInfiniteQuery(e){return e.behavior=Pe(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(X).catch(X)}ensureInfiniteQueryData(e){return e.behavior=Pe(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return me.isOnline()?this.#g.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#y}getMutationCache(){return this.#g}getDefaultOptions(){return this.#l}setDefaultOptions(e){this.#l=e}setQueryDefaults(e,t){this.#b.set(te(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...this.#b.values()],r={};return t.forEach((t=>{re(e,t.queryKey)&&Object.assign(r,t.defaultOptions)})),r}setMutationDefaults(e,t){this.#x.set(te(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...this.#x.values()],r={};return t.forEach((t=>{re(e,t.mutationKey)&&Object.assign(r,t.defaultOptions)})),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...this.#l.queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=ee(t.queryKey,t)),void 0===t.refetchOnReconnect&&(t.refetchOnReconnect="always"!==t.networkMode),void 0===t.throwOnError&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===le&&(t.enabled=!1),t}defaultMutationOptions(e){return e?._defaulted?e:{...this.#l.mutations,...e?.mutationKey&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){this.#y.clear(),this.#g.clear()}}({defaultOptions:{queries:{staleTime:5e3,refetchOnWindowFocus:!1,networkMode:"always"}}}),Ne=K(),Ge=void 0,Re={5:2e3,4:4e3,3:8e3,2:16e3,1:32e3},De="https://cashback-api-staging.operacdn.com/api/public/v8",je="https://cashback-api-production.operacdn.com/api/public/v8",Me=function(e){return new Promise((function(t){return setTimeout(t,e)}))},Fe=!1,qe=function(e){var t;return{avgPaymentTime:e.others.avgPaymentTime,avgTransactionRecognitionTime:0,cashbackTerms:e.texts.cashbackTerms,categories:e.others.categories||[],disableAssistant:e.others.disableBadge,categoryRates:(null===(t=e.rates)||void 0===t?void 0:t.categoryRates)||[],domains:e.basic.domains||[],isFeatured:e.others.isFeatured,maxCashbackNormal:e.others.maxCashbackNormal,previousMaxCashbackNormal:e.others.previousMaxCashbackNormal,floatRateNormal:e.others.floatRateNormal,merchantLogoUrl:e.basic.merchantLogoUrl,merchantLogoId:e.basic.merchantLogoId,merchantName:e.texts.merchantName,merchantId:e.basic.merchantId,offerCountry:e.targeting.countries.toString(),offerId:e.offerId,offerLongDesc:e.texts.offerLongDesc,priority:e.targeting.priority,searchPhrase:e.texts.searchPhrase,showAsAction:e.others.showAsAction,socialProof:e.others.socialProof,validToTimestamp:e.others.validToTimestamp,activationAvailableThroughTheSiteOnly:void 0!==e.others.activationAvailableThroughTheSiteOnly&&e.others.activationAvailableThroughTheSiteOnly,activeIconVisitingShopSite:void 0===e.others.activeIconVisitingShopSite||e.others.activeIconVisitingShopSite,allowedSubdomains:void 0===e.others.allowedSubdomains?[]:e.others.allowedSubdomains,forbiddenSubdomains:void 0===e.others.forbiddenSubdomains?[]:e.others.forbiddenSubdomains,showInShopList:void 0===e.others.showInShopList||e.others.showInShopList,showPopupActivateCb:void 0===e.others.showPopupActivateCb||e.others.showPopupActivateCb,showPopupCbActivated:void 0===e.others.showPopupCbActivated||e.others.showPopupCbActivated}},Ue=function(){var e=t(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c().storage.local.get("whenShouldFetchNext").then((function(e){return e.whenShouldFetchNext}));case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=0;case 5:t=e.t0,Date.now()>t&&Be();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Be=function(){var e=t(o().mark((function e(){var r,n,a,s=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>0&&void 0!==s[0]?s[0]:5,e.next=3,c().storage.local.get(["country","language"]).then((function(e){return n=e.country,a=e.language}));case 3:if(!Ce){e.next=7;break}return e.abrupt("return",Ce);case 7:return Ce=fetch("".concat(Fe?De:je,"/offers?size=2000&country=").concat(n,"&lang=").concat(a,"&source=ext.").concat(Ne)).then((function(e){return e.json()})).then(function(){var e=t(o().mark((function e(t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ce=null,r=t.content,Ge=r.map((function(e){return qe(e)})),e.next=5,c().storage.local.set({CACHE:Ge,whenShouldFetchNext:Date.now()+144e5});case 5:return e.abrupt("return",Ge);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch(function(){var e=t(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Error fetching data: ",t),!(r>0)){e.next=8;break}return e.next=4,Me(Re[r]);case 4:return Ce=null,e.abrupt("return",Be(r-1));case 8:return e.abrupt("return",Ge||[]);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return",Ce);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ve=function(){var e=t(o().mark((function e(){var t,r=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>1&&void 0!==r[1]&&r[1],Fe=r.length>0&&void 0!==r[0]&&r[0],void 0!==Ge){e.next=6;break}return e.next=6,c().storage.local.get("CACHE").then((function(e){return Ge=e.CACHE}));case 6:if(void 0!==Ge&&!t){e.next=9;break}return e.next=9,Be();case 9:return e.abrupt("return",Ge);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ke=function(){var e=t(o().mark((function e(){var t,r=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]&&r[0],e.abrupt("return",c().storage.local.get("userId").then((function(e){return t||!e.userId?c().cookies.get({url:h(),name:"__Secure-cuid"}).then((function(e){return null==e?void 0:e.value})):e.userId})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Qe=function(){var e=t(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c().cookies.get({url:h(),name:"_country"}).then((function(e){return null==e?void 0:e.value})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),He=function(){var e=t(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c().cookies.get({url:h(),name:"csrftoken"}).then((function(e){return null==e?void 0:e.value})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),We=function(){var e=t(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Le.fetchQuery({queryKey:["saving-goals","fetch"],queryFn:function(){return fetch("".concat(h(),"api/cashback/v4/saving-goals/latest")).then((function(e){return e.json()})).catch((function(){}))}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$e=function(){var e=t(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Le.fetchQuery({staleTime:36e5,queryKey:["saving-goals","balance","get"],queryFn:function(){return fetch("".concat(h(),"api/cashback/v4/saving-goals/balances")).then((function(e){return e.json()})).catch((function(){return{pendingAmountBalance:{monetaryBalance:{amount:0,currency:""}},availableAmountBalance:{monetaryBalance:{amount:0,currency:""}},totalBalance:{monetaryBalance:{amount:0,currency:""}}}}))}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ye=function(){var e=t(o().mark((function e(t,r,n,a,s){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=fetch,e.t1="".concat(h(),"api/cashback/v4/saving-goals"),e.t2=JSON.stringify({imageId:a,monetaryAmount:{amount:r,currency:n},name:t,templateId:s}),e.next=5,He();case 5:return e.t3=e.sent,e.t4={"X-CSRFToken":e.t3},e.t5={method:"POST",body:e.t2,headers:e.t4},e.next=10,(0,e.t0)(e.t1,e.t5).finally((function(){Le.invalidateQueries({queryKey:["saving-goals","fetch"]})}));case 10:case"end":return e.stop()}}),e)})));return function(t,r,n,a,s){return e.apply(this,arguments)}}(),Xe=function(){var e=t(o().mark((function e(t,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Le.fetchQuery({queryKey:["saving-goals","templates","get"],queryFn:function(){return fetch("".concat(h(),"api/cashback/saving-goal-templates?currency=").concat(t,"&lang=").concat(r)).then((function(e){return e.json()})).catch((function(){}))}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),Je=function(){var e=t(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=fetch,e.t1="".concat(h(),"api/cashback/v4/saving-goals/latest"),e.t2=JSON.stringify({status:t}),e.next=5,He();case 5:return e.t3=e.sent,e.t4={"X-CSRFToken":e.t3},e.t5={method:"PATCH",body:e.t2,headers:e.t4},e.next=10,(0,e.t0)(e.t1,e.t5).finally((function(){Le.invalidateQueries({queryKey:["saving-goals","fetch"]})}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ze=function(){var e=t(o().mark((function e(){var t,r,n=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]&&n[0],r=n.length>1?n[1]:void 0,e.next=4,Le.fetchQuery({queryKey:["popups","get"],queryFn:function(){return fetch("".concat(t?De:je,"/popups?country=").concat(r.toUpperCase())).then((function(e){return e.json()})).catch((function(){}))}});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();setInterval(Ue,3e5);const Ze=36e5,et=36e5;var tt;c().storage.local.get().then((function(e){(tt=e.uniqueID)||(tt=(1e7.toString()+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(+e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>+e/4).toString(16)})),c().storage.local.set({uniqueID:tt}),rt({category:"impression",action:"assistant_installed"}),U||B||c().tabs.create({url:"".concat(h(),"?extensionInstalled=1&cid=").concat(encodeURIComponent(tt))}))}));var rt=function(e){var t=e.category,r=e.action,n=e.label,a=e.value,s=e.badge_state,o=chrome.runtime.getManifest().version,i={name:r,params:Object.fromEntries(Object.entries({category:t,label:n,value:a,version:o,engagement_time_msec:1,os:j()}).filter((function(e){return void 0!==e[1]})))},c=JSON.stringify({client_id:tt,events:[i]});if(fetch("https://www.google-analytics.com/mp/collect?measurement_id=".concat("G-504Y0HBTWD","&api_secret=").concat("_reSGQFbQ0SmEwlLmJfnNg"),{method:"POST",body:c}),null!=q&&q.statsPrivate){var u=JSON.stringify({action:r.replace(/ |\(|\)/g,"_"),details:{source:"assistant",version:o,category:t,label:n,value:a,badge_state:s}});console.log("%c Reporting stats: feature_events.event_cashback ".concat(u),"color: #88f"),q.statsPrivate.recordSessionEvent("feature_events.event_cashback",u,q.statsPrivate.Priority.NORMAL)}};const nt={defaultMerge:Symbol("deepmerge-ts: default merge"),skip:Symbol("deepmerge-ts: skip")};function at(e,t){return t}function st(e,t){return e.filter((e=>void 0!==e))}var ot;function it(e){return"object"!=typeof e||null===e?0:Array.isArray(e)?2:function(e){if(!ut.includes(Object.prototype.toString.call(e)))return!1;const{constructor:t}=e;if(void 0===t)return!0;const r=t.prototype;return!(null===r||"object"!=typeof r||!ut.includes(Object.prototype.toString.call(r)))&&!!r.hasOwnProperty("isPrototypeOf")}(e)?1:e instanceof Set?3:e instanceof Map?4:5}function ct(e){let t=0,r=e[0]?.[Symbol.iterator]();return{[Symbol.iterator]:()=>({next(){for(;;){if(void 0===r)return{done:!0,value:void 0};const n=r.next();if(!0!==n.done)return{done:!1,value:n.value};t+=1,r=e[t]?.[Symbol.iterator]()}}})}}!function(e){e[e.NOT=0]="NOT",e[e.RECORD=1]="RECORD",e[e.ARRAY=2]="ARRAY",e[e.SET=3]="SET",e[e.MAP=4]="MAP",e[e.OTHER=5]="OTHER"}(ot||(ot={}));const ut=["[object Object]","[object Module]"],lt={mergeRecords:function(e,t,r){const n={};for(const o of function(e){const t=new Set;for(const r of e)for(const e of[...Object.keys(r),...Object.getOwnPropertySymbols(r)])t.add(e);return t}(e)){const i=[];for(const t of e)s=o,"object"==typeof(a=t)&&Object.prototype.propertyIsEnumerable.call(a,s)&&i.push(t[o]);if(0===i.length)continue;const c=t.metaDataUpdater(r,{key:o,parents:e}),u=ft(i,t,c);u!==nt.skip&&("__proto__"===o?Object.defineProperty(n,o,{value:u,configurable:!0,enumerable:!0,writable:!0}):n[o]=u)}var a,s;return n},mergeArrays:function(e){return e.flat()},mergeSets:function(e){return new Set(ct(e))},mergeMaps:function(e){return new Map(ct(e))},mergeOthers:function(e){return e.at(-1)}};function ht(...e){return function(){const e=function(e,t){return{defaultMergeFunctions:lt,mergeFunctions:{...lt,...Object.fromEntries(Object.entries(e).filter((([e,t])=>Object.hasOwn(lt,e))).map((([e,t])=>!1===t?[e,lt.mergeOthers]:[e,t])))},metaDataUpdater:e.metaDataUpdater??at,deepmerge:t,useImplicitDefaultMerging:e.enableImplicitDefaultMerging??!1,filterValues:!1===e.filterValues?void 0:e.filterValues??st,actions:nt}}({},t);function t(...t){return ft(t,e,undefined)}return t}()(...e)}function ft(e,t,r){const n=t.filterValues?.(e,r)??e;if(0===n.length)return;if(1===n.length)return dt(n,t,r);const a=it(n[0]);if(0!==a&&5!==a)for(let e=1;e<n.length;e++)if(it(n[e])!==a)return dt(n,t,r);switch(a){case 1:return function(e,t,r){const n=t.mergeFunctions.mergeRecords(e,t,r);return n===nt.defaultMerge||t.useImplicitDefaultMerging&&void 0===n&&t.mergeFunctions.mergeRecords!==t.defaultMergeFunctions.mergeRecords?t.defaultMergeFunctions.mergeRecords(e,t,r):n}(n,t,r);case 2:return function(e,t,r){const n=t.mergeFunctions.mergeArrays(e,t,r);return n===nt.defaultMerge||t.useImplicitDefaultMerging&&void 0===n&&t.mergeFunctions.mergeArrays!==t.defaultMergeFunctions.mergeArrays?t.defaultMergeFunctions.mergeArrays(e):n}(n,t,r);case 3:return function(e,t,r){const n=t.mergeFunctions.mergeSets(e,t,r);return n===nt.defaultMerge||t.useImplicitDefaultMerging&&void 0===n&&t.mergeFunctions.mergeSets!==t.defaultMergeFunctions.mergeSets?t.defaultMergeFunctions.mergeSets(e):n}(n,t,r);case 4:return function(e,t,r){const n=t.mergeFunctions.mergeMaps(e,t,r);return n===nt.defaultMerge||t.useImplicitDefaultMerging&&void 0===n&&t.mergeFunctions.mergeMaps!==t.defaultMergeFunctions.mergeMaps?t.defaultMergeFunctions.mergeMaps(e):n}(n,t,r);default:return dt(n,t,r)}}function dt(e,t,r){const n=t.mergeFunctions.mergeOthers(e,t,r);return n===nt.defaultMerge||t.useImplicitDefaultMerging&&void 0===n&&t.mergeFunctions.mergeOthers!==t.defaultMergeFunctions.mergeOthers?t.defaultMergeFunctions.mergeOthers(e):n}var pt,gt,mt,vt,At;function yt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function bt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?yt(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var xt,Ot,wt,St,Et,_t,Tt,Pt,It=function(e){return e.NEUTRAL="Neutral",e.AVAILABLE="Available",e.AVAILABLE_RED="Available_Red",e.AVAILABLE_YELLOW="Available_Yellow",e.ACTIVE="Active",e}(It||{}),kt=a(a(a(a(a({},It.NEUTRAL,null===(pt=globalThis.opr)||void 0===pt||null===(pt=pt.cashbackPrivate)||void 0===pt||null===(pt=pt.BadgeState)||void 0===pt?void 0:pt.DISABLED),It.AVAILABLE,null===(gt=globalThis.opr)||void 0===gt||null===(gt=gt.cashbackPrivate)||void 0===gt||null===(gt=gt.BadgeState)||void 0===gt?void 0:gt.WARNING),It.AVAILABLE_RED,null===(mt=globalThis.opr)||void 0===mt||null===(mt=mt.cashbackPrivate)||void 0===mt||null===(mt=mt.BadgeState)||void 0===mt?void 0:mt.WARNING),It.AVAILABLE_YELLOW,null===(vt=globalThis.opr)||void 0===vt||null===(vt=vt.cashbackPrivate)||void 0===vt||null===(vt=vt.BadgeState)||void 0===vt?void 0:vt.IDLE),It.ACTIVE,null===(At=globalThis.opr)||void 0===At||null===(At=At.cashbackPrivate)||void 0===At||null===(At=At.BadgeState)||void 0===At?void 0:At.ACTIVE),Ct={count:0,nextPopupNotBefore:0,nextPendingViewSection:0},Lt={automaticTimers:{welcome:0,competitor:0,notPartner:0,promos:{}},activationPopupCounter:0},Nt=!1,Gt=new Promise((function(e){xt=e})),Rt={},Dt=!1,jt=!1,Mt=!1,Ft=!1,qt=function(){var e=t(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ze(l(),wt).then((function(e){return Et=e})).catch((function(){return Et={checkout:[],competitor:[],notPartner:[]}}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ut={},Bt={},Vt=function(e,t){var r=0;switch(e){case g.COMPETITOR:r=Lt.automaticTimers.competitor;break;case g.WELCOME:r=Lt.automaticTimers.welcome;break;case g.NOT_PARTNER:r=Lt.automaticTimers.notPartner;break;case g.PROMO:return _(j(),Dt,t,Lt.automaticTimers.promos);default:return!0}return Date.now()>r},Kt=function(e){return e&&j()!==p.OperaGX},Qt=function(e){var t,r=!1;switch(e){case g.COMPETITOR:Lt.automaticTimers.competitor=Date.now()+864e5,r=!0;break;case g.WELCOME:Lt.automaticTimers.welcome=Date.now()+et,r=!0;break;case g.NOT_PARTNER:Lt.automaticTimers.notPartner=Date.now()+et,r=!0;break;case g.PROMO:Lt.automaticTimers.promos=bt({},(t=Lt.automaticTimers.promos,y(y(y({},{counter1:0,time1:-1,counter2:0,time2:-1}),t),a(a({},"counter"+(E()?"1":"2"),1),"time"+(E()?"1":"2"),Date.now())))),r=!0}return r&&c().storage.local.set({popupsContext:Lt}),r},Ht=function(){var e,t=Date.now();e=function(e){return e.expire<t},Object.keys(Rt).forEach((function(t){e(Rt[t])&&delete Rt[t]})),c().storage.local.set({visitedCashbackList:Rt})},Wt=function(){var e=t(o().mark((function e(t){var r,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ve(l());case 2:return r=e.sent,n=(null==r?void 0:r.filter((function(e){return e.domains.map((function(r){return M(r,t,e.forbiddenSubdomains)})).reduce((function(e,t){return t||e}))})))||[],e.abrupt("return",{offers:n,allOffers:r,url:t});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$t=function(){var e=t(o().mark((function e(t,r){var n,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=["de","gb","us","es","mx","pl","br","ua"],a=["de","en","es","pl","pt","ru","uk"],U&&(r=c().i18n.getUILanguage()),t=n.indexOf(t)>-1?t:"pl",r=a.indexOf(r)>-1?r:"en",wt===t&&St===r){e.next=15;break}return wt=t,St=r,c().storage.local.set({country:wt,language:St}),e.next=13,Ve(l(),!0);case 13:return e.next=15,qt();case 15:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),Yt=function(){var e=t(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(jt=t,e.t0=c().storage.local,e.t1=jt,!t){e.next=9;break}return e.next=6,Ke(!0);case 6:e.t2=e.sent,e.next=10;break;case 9:e.t2="";case 10:e.t3=e.t2,e.t4={isUserLogged:e.t1,userId:e.t3},e.t0.set.call(e.t0,e.t4),!Dt&&t&&(Dt=!0,c().storage.local.set({isUserLoggedBefore:Dt}));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Xt=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-1;clearTimeout(_t);var o,i,u,l,h=-1===s;if(n?t=h&&(null===(o=Ut[e])||void 0===o?void 0:o.icon)||t:(Ut[e]=bt(bt({},Ut[e]),{},{icon:t}),c().storage.local.set({cacheTabState:Ut})),t===It.AVAILABLE&&(r.length&&(U&&r[0].disableAssistant||!U&&!r[0].activeIconVisitingShopSite)?t=It.NEUTRAL:jt&&!Nt?(s=10,t=It.AVAILABLE_RED):t=It.AVAILABLE_YELLOW),U)if(h&&t!==It.NEUTRAL&&!n&&rt({action:"badge_displayed",category:"impression",badge_state:kt[t].toLowerCase()}),null!==(i=opr)&&void 0!==i&&null!==(i=i.cashbackPrivate)&&void 0!==i&&i.setTabState)null===(u=opr)||void 0===u||u.cashbackPrivate.setTabState(e,kt[t]);else if(a){var f;null===(f=globalThis.opr)||void 0===f||f.cashbackPrivate.setCashbackBadgeState(Number(a),kt[t])}U||null===(l=c().action)||void 0===l||l.setIcon({tabId:e,path:{32:"icons/32/Icon_".concat(V()?"Dark":"Light","_").concat(t,".png")}}).catch(console.log),s>0&&(_t=setTimeout((function(){return Xt(e,t===It.AVAILABLE_RED?It.AVAILABLE_YELLOW:It.AVAILABLE_RED,r,n,a,s-1)}),350))},Jt=function(){var e=t(o().mark((function e(t,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c().scripting.executeScript({target:{tabId:t},func:function(e,t,r){return[globalThis.____dify_cashback_language=e,globalThis.____dify_cashback_country=t,globalThis.____dify_cashback_injected_url,globalThis.____dify_cashback_injected_url=r]},args:[St,wt,r.href]}).then((function(e){var t=e[0].result[2];return t?{injected:t===r.href,shouldSendStats:t!==r.href,injectedAtLeastOnce:t}:{injected:!1,shouldSendStats:!0,injectedAtLeastOnce:!1}}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),zt=function(e,t,r){var n,a,s,o=!1,i=(n=Et.checkout,a=t.merchantId,(null==n||null===(s=n.find((function(e){return e.merchantId===a})))||void 0===s?void 0:s.urls)||[]);return null==i||i.forEach((function(n){var a,s=new URL(n);s.host===e.host&&(s.pathname===e.pathname||""!==s.hash&&s.hash===e.hash||""!==s.search&&s.search===e.search)&&((null===(a=r[t.offerId])||void 0===a?void 0:a.checkout_shown_expire)+Ze||0)<Date.now()&&(r[t.offerId]=bt(bt({},r[t.offerId]),{},{checkout_shown_expire:Date.now()+Ze}),o=!0)})),o},Zt=function(e,t,r,n,a){var s=function(){Xt(e,t?It.ACTIVE:It.AVAILABLE,r,n,a)};q&&q.cashbackPrivate&&!U?c().tabs.query({active:!0}).then((function(t){var o=t.find((function(t){return t.id===e}));o&&q.cashbackPrivate.getCashbackBadgeState(o.windowId,(function(t){var o=!0;switch(t){case q.cashbackPrivate.BadgeState.IDLE:case q.cashbackPrivate.BadgeState.WARNING:o=!1;case q.cashbackPrivate.BadgeState.ACTIVE:Xt(e,o?It.ACTIVE:It.AVAILABLE,r,n,a);break;case q.cashbackPrivate.BadgeState.DISABLED:s()}}))})):s()},er=function(e,r){c().tabs.query({}).then((function(n){var s=n.find((function(t){return t.id===e})),i=null==s?void 0:s.windowId;if(null!=s&&s.active)if(r&&r.startsWith("http")){var u=new URL(r);Jt(e,u).then((function(n){if(n.injected||(delete Ut[e],c().storage.local.set({cacheTabState:Ut})),u.hostname.indexOf("cashback.opera.com")>-1||u.hostname.indexOf("cashback.op-test.net")>-1||u.hostname.indexOf("localhost")>-1)n.injectedAtLeastOnce||c().scripting.executeScript({target:{tabId:e},files:["./content_getdify.js"]}).catch(console.log),Xt(e,It.NEUTRAL,[],!1,i);else{if(("us"===wt||"ua"===wt)&&!Dt)return void Xt(e,It.NEUTRAL,[],!1,i);Wt(r).then(function(){var s=t(o().mark((function t(s){var l,h,f,d,m,v,A,y,b,x,O;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(l=s.offers,h=s.allOffers,Ht(),f=!l.length&&!Dt&&Vt(g.COMPETITOR,u)&&W(Et.competitor,u)&&(j()!==p.OperaGX||["GB","ES"].indexOf(wt.toUpperCase())>-1),Nt=!l.length&&Dt&&Vt(g.NOT_PARTNER,u)&&j()!==p.OperaGX&&$(Et.notPartner,u).length>0,t.t0=i,!t.t0){t.next=9;break}return t.next=8,ar(l,h,r,e,i.toString());case 8:t.t0=t.sent;case 9:if(d=t.t0,m=!1,v=f?g.COMPETITOR:Nt?g.NOT_PARTNER:l.length?Dt?g.ACTIVATION:g.WELCOME:null,!(l.length||f||Nt)){t.next=29;break}if(A=!1,jt&&l.forEach((function(e){var t=Rt[e.offerId];t&&t.expire>Date.now()&&(A=!0)})),Zt(e,A,l,n.injected,i),n.injected){t.next=27;break}if(!U){t.next=26;break}if(y=Dt&&!A&&l.reduce((function(e,t){return e||zt(u,t,Rt)}),!1),v=y?g.CHECKOUT:v,!F(null==d?void 0:d.data,wt,y)||!Vt(v,u)){t.next=24;break}return m=!0,t.next=24,or(i,!1,v);case 24:t.next=27;break;case 26:c().scripting.executeScript({target:{tabId:e},files:["./content.js"]}).catch(console.log);case 27:t.next=30;break;case 29:Xt(e,It.NEUTRAL,[],n.injected,i);case 30:if(m||!U||n.injected||!Vt(g.PROMO,u)){t.next=36;break}return Xt(e,It.AVAILABLE,[],(null===(b=Ut[e])||void 0===b?void 0:b.icon)!==It.NEUTRAL,i),v=g.PROMO,m=!0,t.next=36,or(i,!1,v);case 36:n.shouldSendStats&&v&&m&&(x=a(a(a(a(a(a({},g.PROMO,"".concat("christmas_2023_"+(E()?1:2),"_visited")),g.COMPETITOR,"competitor_page_visited"),g.NOT_PARTNER,"non_partner_page_visited"),g.CHECKOUT,"checkout_page_visited"),g.WELCOME,"welcome_page_visited"),g.ACTIVATION,"supported_page_visited"),O=u.host.split(".").splice(u.host.startsWith("www.")?1:0).join("."),rt({action:x[v],category:"impression",label:O}));case 37:case"end":return t.stop()}}),t)})));return function(e){return s.apply(this,arguments)}}())}})).catch((function(t){console.log("Trouble: ",t),Xt(e,It.NEUTRAL,[],!1,i)}))}else Xt(e,It.NEUTRAL,[],!1,i)}))},tr=function(e,t){console.log("Sending message: ",e),void 0!==t?c().tabs.sendMessage(t,e).catch(console.log):c().runtime.sendMessage(e).catch(console.log)},rr=function(e){var t,r;return null!==(t=null===(r=Rt[e.offerId])||void 0===r?void 0:r.expire)&&void 0!==t?t:0},nr=function(e,t){void 0!==e?c().tabs.get(e).then((function(t){Wt(t.url).then((function(t){var r=t.offers,n=t.allOffers,a=t.url;sr(r,a,n||[],e)}))})):Q(Number(t)).then((function(e){e&&Wt(e.url).then((function(t){var r=t.offers,n=t.allOffers,a=t.url;sr(r,a,n||[],e.id,e.windowId.toString())}))}))},ar=function(){var e=t(o().mark((function e(t,r,n){var a,s,i,c,u,h,f,d,p,m,A,y,b,x,O,w=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d=w.length>3&&void 0!==w[3]?w[3]:void 0,p=w.length>4&&void 0!==w[4]?w[4]:void 0,m=t.length&&t.sort((function(e,t){return rr(e)<rr(t)?1:-1})).find((function(e){return Rt[e.offerId]})),A=d&&Bt[d]?Bt[d].urls:[],y=!1,!Kt(jt)){e.next=10;break}return e.next=8,$e();case 8:b=e.sent,y=!!((null===(x=b)||void 0===x||null===(x=x.totalBalance)||void 0===x||null===(x=x.monetaryBalance)||void 0===x?void 0:x.amount)>0)||Lt.activationPopupCounter>3;case 10:return O={type:v.OFFER_DATA,data:{offer:t.length&&t[0],allOffers:r,browser:j(),theme:V()?"dark":"light",activated:bt({expire:0,closed_till:0,tabId:d,domains:[n]},m&&Rt[m.offerId]),settingsForPage:bt({dont_open_again:!1,dont_open_again_today:0,dont_open_all_shops:Mt,disable_saving_goals:Ft},t.length&&Ot[t[0].offerId]),isActivated:jt&&!!m&&Rt[m.offerId].expire>Date.now(),url:n,staging:l(),redirs:A,isUserLogged:jt,isUserLoggedBefore:Dt,manualPopup:null===(a=Ut[d])||void 0===a?void 0:a.isManualPopup,notPartnerMerchantIds:(null===(s=Ut[d])||void 0===s?void 0:s.popup_type)===g.NOT_PARTNER&&$(Et.notPartner,new URL(n)),popup_type:null===(i=Ut[d])||void 0===i?void 0:i.popup_type,windowId:p,savingGoalsEnabled:y,savingGoalsBalance:bt({},b&&{total:(null===(c=b)||void 0===c||null===(c=c.totalBalance.monetaryBalance)||void 0===c?void 0:c.amount)||0,available:(null===(u=b)||void 0===u||null===(u=u.availableAmountBalance)||void 0===u||null===(u=u.monetaryBalance)||void 0===u?void 0:u.amount)||0,pending:(null===(h=b)||void 0===h||null===(h=h.pendingAmountBalance)||void 0===h||null===(h=h.monetaryBalance)||void 0===h?void 0:h.amount)||0,currency:null===(f=b)||void 0===f||null===(f=f.totalBalance)||void 0===f||null===(f=f.monetaryBalance)||void 0===f?void 0:f.currency}),savingGoalsPopups:Ct}},e.abrupt("return",O);case 12:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),sr=function(){var e=t(o().mark((function e(t,r,n){var a,s,i=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.length>3&&void 0!==i[3]?i[3]:void 0,s=i.length>4&&void 0!==i[4]?i[4]:void 0,e.t0=tr,e.next=5,ar(t,n,r,a,s);case 5:e.t1=e.sent,e.t2=s?void 0:a,(0,e.t0)(e.t1,e.t2);case 8:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),or=function(){var e=t(o().mark((function e(t){var r,n,a,s,i=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(i.length>1&&void 0!==i[1])||i[1],a=i.length>2?i[2]:void 0,e.next=4,Gt;case 4:return e.next=6,Q(t);case 6:s=e.sent,a=a||(null===(r=Ut[s.id])||void 0===r?void 0:r.popup_type)||g.MAIN_NON_AUTOMATIC,Ut[s.id]=bt(bt({},Ut[s.id]),{},{popup_type:a,isManualPopup:n}),c().storage.local.set({cacheTabState:Ut}),n||Qt(a),opr.cashbackPrivate.showPopup(t,Dt?40:280);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ir=function(){var e=t(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Gt;case 2:rt({category:"impression",action:"popup_closed"});case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),cr=function(e,t){Ve(l()).then((function(r){var n,a=null==r?void 0:r.find((function(t){return t.offerId===e}));((null===(n=Rt[e])||void 0===n?void 0:n.expire)||0)<Date.now()&&(Lt.activationPopupCounter++,c().storage.local.set({popupsContext:Lt})),Rt[e]=bt(bt({},Rt[e]||{}),{},{expire:Date.now()+36e5,domains:null==a?void 0:a.domains,tabId:t,closed_till:void 0}),c().storage.local.set({visitedCashbackList:Rt})}))},ur=function(e,t){tr({type:v.SETTINGS_FOR_PAGE,data:Object.assign({dont_open_again:!1,dont_open_again_today:0,dont_open_all_shops:Mt,disable_saving_goals:Ft},Ot[e])},t)},lr=function(){var e=t(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(wt){e.next=16;break}return e.next=3,Qe();case 3:if(e.t0=e.sent,e.t0){e.next=11;break}if(e.t1=U,!e.t1){e.next=10;break}return e.next=9,new Promise((function(e){opr.cashbackPrivate.getCountry(e)}));case 9:e.t1=e.sent.toLowerCase();case 10:e.t0=e.t1;case 11:return t=e.t0,e.next=14,$t(t);case 14:e.next=18;break;case 16:return e.next=18,$t(wt,St);case 18:return e.next=20,Ve(l());case 20:return e.next=22,qt();case 22:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();c().runtime.onMessage.addListener(function(){var e=t(o().mark((function e(t,r){var n,a,s,i,h,f,d,p,g,A,y,b,x;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Gt;case 2:p=t,g=r,console.log("Received message: ",p),e.t0=p.type,e.next=e.t0===v.FETCH_OFFER_DATA?8:e.t0===v.SET_STAGING?10:e.t0===v.POPUP_SEEN?14:e.t0===v.ACTIVATE_CASHBACK?16:e.t0===v.GET_SETTINGS_FOR_PAGE?18:e.t0===v.SET_SETTINGS_FOR_PAGE?20:e.t0===v.IS_LOGGED?43:e.t0===v.SEND_STATS?45:e.t0===v.GET_VERSION?47:e.t0===v.SET_LANGUAGE?49:e.t0===v.GET_SAVING_GOAL_DATA?52:e.t0===v.GET_SAVING_GOAL_TEMPLATES?54:e.t0===v.SET_SAVING_GOAL?74:e.t0===v.UPDATE_SAVING_GOAL?78:e.t0===v.RESET_SAVING_GOAL_COUNTER?80:e.t0===v.INCREASE_SAVING_GOAL_COUNTER?84:e.t0===v.MARK_PENDING_VIEW_SECTION?88:e.t0===v.RESET_STORAGE?91:94;break;case 8:return nr(null===(n=g.tab)||void 0===n?void 0:n.id,null===(a=p.data)||void 0===a?void 0:a.windowId),e.abrupt("break",94);case 10:return O=p.data.value,u=O,c().storage.local.set({staging:O}),Le.invalidateQueries({queryKey:["saving-goals"]}),location.reload(),e.abrupt("break",94);case 14:return Ve(l()).then((function(e){var t=null==e?void 0:e.find((function(e){return e.offerId===p.data.offerId}));t&&Dt&&(Rt[t.offerId]=bt(bt({},Rt[t.offerId]||{}),{},{closed_till:Date.now()+36e5}),c().storage.local.set({visitedCashbackList:Rt}))})),e.abrupt("break",94);case 16:return cr(p.data.offerId,null===(s=g.tab)||void 0===s?void 0:s.id),e.abrupt("break",94);case 18:return ur(p.data.offerId,null===(i=g.tab)||void 0===i?void 0:i.id),e.abrupt("break",94);case 20:(A=p.data).offerId&&(Ot[A.offerId]=Ot[A.offerId]||{}),e.t1=o().keys(A);case 23:if((e.t2=e.t1()).done){e.next=40;break}y=e.t2.value,e.t3=y,e.next=e.t3===m.DONT_OPEN_AGAIN_TODAY?28:e.t3===m.DONT_OPEN_AGAIN?30:e.t3===m.DONT_OPEN_ALL_SHOPS?32:e.t3===m.DISABLE_SAVING_GOALS?35:38;break;case 28:return Ot[A.offerId][y]=(A.dont_open_again_today||0)>0?Date.now()+864e5:void 0,e.abrupt("break",38);case 30:return Ot[A.offerId][y]=A[y],e.abrupt("break",38);case 32:return Mt=!!A[y],c().storage.local.set({disableAllPopups:Mt}),e.abrupt("break",38);case 35:return Ft=!!A[y],c().storage.local.set({disableSavingGoals:Ft}),e.abrupt("break",38);case 38:e.next=23;break;case 40:return c().storage.local.set({pageSettings:Ot}),ur(p.data.offerId,null===(h=g.tab)||void 0===h?void 0:h.id),e.abrupt("break",94);case 43:return Yt(!!p.data.logged),e.abrupt("break",94);case 45:return rt(bt({},p.data)),e.abrupt("break",94);case 47:return tr({type:v.VERSION,data:{version:K()}},null===(f=g.tab)||void 0===f?void 0:f.id),e.abrupt("break",94);case 49:return b=p.data,$t(b.country,b.language),e.abrupt("break",94);case 52:return We().then((function(e){var t,r,n;tr({type:v.SAVING_GOAL_DATA,data:{imageId:null==e?void 0:e.imageId,imageUrl:null==e?void 0:e.imageUrl,templateId:null==e?void 0:e.templateId,amount:null==e||null===(t=e.monetaryAmount)||void 0===t?void 0:t.amount,currency:null==e||null===(r=e.monetaryAmount)||void 0===r?void 0:r.currency,name:null==e?void 0:e.name,status:null==e?void 0:e.status}},null===(n=g.tab)||void 0===n?void 0:n.id)})),e.abrupt("break",94);case 54:return e.next=56,$e();case 56:if(e.t7=d=e.sent,e.t6=null===e.t7,e.t6){e.next=60;break}e.t6=void 0===d;case 60:if(e.t5=e.t6,e.t5){e.next=63;break}e.t5=null===(d=d.totalBalance.monetaryBalance)||void 0===d;case 63:if(!e.t5){e.next=67;break}e.t8=void 0,e.next=68;break;case 67:e.t8=d.currency;case 68:if(e.t4=e.t8,e.t4){e.next=71;break}e.t4="USD";case 71:return x=e.t4,Xe(x,St).then((function(e){var t;tr({type:v.SAVING_GOAL_TEMPLATES,data:((null==e?void 0:e.content)||[]).map((function(e){return{imageId:e.imageId,imageUrl:e.imageUrl,templateId:e.templateId,name:e.name,amount:e.price.amount,currency:e.price.currency}}))},null===(t=g.tab)||void 0===t?void 0:t.id)})),e.abrupt("break",94);case 74:return Ye(p.data.name,p.data.amount,p.data.currency,p.data.imageId,p.data.templateId),Ct={count:0,nextPopupNotBefore:0,nextPendingViewSection:0},c().storage.local.set({savingGoalsPopups:Ct}),e.abrupt("break",94);case 78:return Je(p.data),e.abrupt("break",94);case 80:return Ct.count=0,Ct.nextPopupNotBefore=0,c().storage.local.set({savingGoalsPopups:Ct}),e.abrupt("break",94);case 84:return Ct.count++,Ct.nextPopupNotBefore=Date.now()+864e5,c().storage.local.set({savingGoalsPopups:Ct}),e.abrupt("break",94);case 88:return Ct.nextPendingViewSection=Date.now()+864e5,c().storage.local.set({savingGoalsPopups:Ct}),e.abrupt("break",94);case 91:return c().storage.local.clear(),location.reload(),e.abrupt("break",94);case 94:case"end":return e.stop()}var O}),e)})));return function(t,r){return e.apply(this,arguments)}}()),c().tabs.onCreated.addListener(function(){var e=t(o().mark((function e(t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Gt;case 2:t.id&&(U||null===(r=c().pageAction)||void 0===r||r.show(t.id),er(t.id,t.url));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),U&&(null===(Tt=globalThis.opr.cashbackPrivate)||void 0===Tt||null===(Tt=Tt.onCashbackButtonPressed)||void 0===Tt||Tt.addListener(or),null===(Pt=globalThis.opr.cashbackPrivate)||void 0===Pt||null===(Pt=Pt.onCashbackPopupClosed)||void 0===Pt||Pt.addListener(ir)),c().tabs.onUpdated.addListener(function(){var e=t(o().mark((function e(t,r,n){var a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Gt;case 2:U||null===(a=c().pageAction)||void 0===a||a.show(t),er(t,n.url);case 4:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()),c().tabs.onActivated.addListener(function(){var e=t(o().mark((function e(t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Gt;case 2:U||null===(r=c().pageAction)||void 0===r||r.show(t.tabId),c().tabs.get(t.tabId).then((function(e){er(t.tabId,e.url)}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),U||c().runtime.setUninstallURL("".concat(h(),"?extensionUninstalled=1&cid=").concat(encodeURIComponent(tt))),c().tabs.query({}).then(function(){var e=t(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Gt;case 2:U||t.forEach((function(e){var t;return null===(t=c().pageAction)||void 0===t?void 0:t.show(e.id)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),c().webRequest.onHeadersReceived.addListener((function(e){if(Bt[e.tabId]&&Bt[e.tabId].requestId===e.requestId){Bt[e.tabId].urls.push(e.url);var t=new URL(Bt[e.tabId].urls[0]),r=new URL(e.url),n=t.searchParams.get("offerId"),a=h();0===a.indexOf(t.origin)&&0!==a.indexOf(r.origin)&&n&&cr(n)}else Bt[e.tabId]={urls:[e.url],requestId:e.requestId};Bt[e.tabId].urls.forEach((function(e){(function(e){if("allegro.pl"===e.host){var t=e.searchParams.get("utm_source"),r=e.searchParams.get("utm_campaign");return!!(t&&"ctr_b"!==t||r&&"55441244-6905-4da3-be17-24d7f3e0271c"!==r)}return!1})(new URL(e))&&Wt(e).then((function(e){e.offers.forEach((function(e){return function(e){delete Rt[e],c().storage.local.set({visitedCashbackList:Rt})}(e.offerId)}))}))}))}),{urls:["<all_urls>"],types:["main_frame"]}),console.log("%c --- Cashback Assistant ver: "+K()+" ----","color: #0f0"),!U&&B?(rt({category:"issue",action:"assistant_launched_without_cashback_flag"}),c().tabs.query({url:"*://cashback.opera.com/*?extensionInstalled*"}).then((function(e){return null==e?void 0:e.forEach((function(e){return c().tabs.remove(e.id)}))}))):c().storage.local.get().then(function(){var e=t(o().mark((function e(t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ot=t.pageSettings||{},jt=t.isUserLogged||jt,Dt=t.isUserLoggedBefore||Dt,Mt=t.disableAllPopups||Mt,Ft=t.disableSavingGoals||Ft,Ct=ht(Ct,t.savingGoalsPopups||{}),Ut=t.cacheTabState||{},Lt=ht(Lt,t.popupsContext||{}),Rt=t.visitedCashbackList||{},wt=t.country,St=t.language,r=-1===Object.keys(t).indexOf("userId"),Dt&&!r){e.next=18;break}return e.t0=Yt,e.next=16,Ke(!0);case 16:e.t1=!!e.sent,(0,e.t0)(e.t1);case 18:return e.next=20,D();case 20:return e.next=22,lr();case 22:xt(!0);case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())})()})();